DELETE FROM CT_TRIPS;
DELETE FROM CT_USERS;
DELETE FROM CT_ROUTES;

DROP TABLE CT_TRIPS;
DROP TABLE CT_ROUTES;
DROP TABLE CT_USERS;


CREATE TABLE CT_USERS
(
user_id INTEGER PRIMARY KEY NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
username VARCHAR(32) NOT NULL UNIQUE,
password VARCHAR(32) NOT NULL,
role INTEGER NOT NULL,
active INTEGER NOT NULL
);

INSERT INTO CT_USERS (username, password, role, active) VALUES ('admin', '21232f297a57a5a743894a0e4a801fc3', 1, 1);

CREATE TABLE CT_ROUTES
(
route_id INTEGER PRIMARY KEY NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
description VARCHAR(256) NOT NULL,
user_id INTEGER NOT NULL CONSTRAINT ct_users_foreign_key
        REFERENCES CT_USERS ON DELETE CASCADE ON UPDATE RESTRICT,
route_start VARCHAR(32) NOT NULL,
route_end VARCHAR(32) NOT NULL,
CONSTRAINT unique_desc_user UNIQUE(description, user_id)
);

INSERT INTO CT_ROUTES (user_id, description, route_start, route_end) VALUES (1, 'TEST ROUTE', 'rstart', 'rend');

CREATE TABLE CT_TRIPS
(
trip_id INTEGER PRIMARY KEY NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
route_id INTEGER NOT NULL CONSTRAINT ct_routes_foreign_key
	REFERENCES CT_ROUTES ON DELETE CASCADE ON UPDATE RESTRICT,
start_time TIMESTAMP,
end_time TIMESTAMP,
status INTEGER
);

INSERT INTO CT_TRIPS (route_id, start_time, end_time, status) VALUES (1, CURRENT_TIMESTAMP, NULL, 0);
